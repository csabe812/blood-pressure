<div class="container mt-2">
    <form [formGroup]="bloodDataForm" (ngSubmit)="onSubmit()">
        <h1 class="text-center">Add Reactive Form (dynamic) data</h1>
        <div formArrayName="data">
            <div class="row g-3 my-2"
                *ngFor="let bloodData of bloodDataForm.controls.data.controls; let dataIdx = index">
                <div class="col-md-4 offset-md-4 border border-secondary">
                    <div class="d-flex justify-content-between my-1">
                        <h3 id="data-idx-{{dataIdx}}">Data idx: {{dataIdx}}</h3>
                        <button class="btn btn-danger" (click)="onDeleteDataById(dataIdx)" id="delete-id-{{dataIdx}}">X</button>
                    </div>
                    <div class="mb-2" [formGroupName]="dataIdx">
                        <div class="form-group">
                            <label for="sys">Sys {{dataIdx}}</label>
                            <input type="number" class="form-control" id="sys-{{dataIdx}}" formControlName="sys"
                                [ngClass]="{ 'is-invalid': (submitted || bloodData.controls.sys.touched) && bloodData.controls.sys.invalid }">
                            <div *ngIf="bloodData.controls.sys.errors" class="invalid-feedback">
                                <div *ngIf="bloodData.controls.sys.errors.required" id="sys-required-error">Sys is required</div>
                                <div *ngIf="bloodData.controls.sys.errors.min" id="sys-min-error">Minimum value is (50).</div>
                                <div *ngIf="bloodData.controls.sys.errors.max" id="sys-max-error">Maximum value is (250).</div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="dia">Dia</label>
                            <input type="number" class="form-control" id="dia-{{dataIdx}}" formControlName="dia"
                                [ngClass]="{ 'is-invalid': (submitted || bloodData.controls.dia.touched) && bloodData.controls.dia.invalid }">
                            <div *ngIf="bloodData.controls.dia.errors" class="invalid-feedback">
                                <div *ngIf="bloodData.controls.dia.errors.required" id="dia-required-error">Dia is required</div>
                                <div *ngIf="bloodData.controls.dia.errors.min" id="dia-min-error">Minimum value is (20).</div>
                                <div *ngIf="bloodData.controls.dia.errors.max" id="dia-max-error">Maximum value is (200).</div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="pulse">Pulse</label>
                            <input type="number" class="form-control" id="pulse-{{dataIdx}}" formControlName="pulse"
                                [ngClass]="{ 'is-invalid': (submitted || bloodData.controls.pulse.touched) && bloodData.controls.pulse.invalid }">
                            <div *ngIf="bloodData.controls.pulse.errors" class="invalid-feedback">
                                <div *ngIf="bloodData.controls.pulse.errors.required" id="pulse-required-error">Pulse is required</div>
                                <div *ngIf="bloodData.controls.pulse.errors.min" id="pulse-min-error">Minimum value is (20).</div>
                                <div *ngIf="bloodData.controls.pulse.errors.max" id="pulse-max-error">Maximum value is (220).</div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="other">Other</label>
                            <textarea class="form-control" id="other" formControlName="other"
                                style="height: 120px"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="mood">Mood</label>
                            <select class="form-select" id="mood" formControlName="mood">
                                <option *ngFor="let mod of moods" [value]="mod">{{mod}}</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-4 offset-md-4">
                    <button class="btn btn-secondary w-100 mt-3" routerLink="/">Back</button>
                    <button type="button" class="btn btn-success w-100 mt-2" (click)="onAddNewData()" id="add-new-data">Add new data</button>
                    <button *ngIf="bloodDataForm.controls.data.length > 0" type="submit" class="btn btn-primary w-100 mt-2" id="submit-btn">Submit</button>
                </div>
            </div>
        </div>
    </form>
</div>